(this.webpackJsonpreagan=this.webpackJsonpreagan||[]).push([[0],{203:function(e){e.exports=JSON.parse('{"name":"reagan","version":"0.1.2","private":true,"homepage":"https://trellisfw.github.io/reagan/","dependencies":{"@emotion/core":"^10.0.27","@material-ui/core":"^4.9.7","@oada/oada-id-client":"^1.0.4","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","@trellisfw/masklink":"^1.0.4","@trellisfw/signatures":"^2.1.0","@types/jest":"^25.1.4","@types/node":"^13.9.0","@types/react":"^16.9.23","@types/react-dom":"^16.9.5","addressbar":"^1.0.3","axios":"^0.19.2","bluebird":"^3.7.2","classnames":"^2.2.6","concurrently":"^5.1.0","fuse.js":"^5.0.7-beta","gh-pages":"^2.2.0","hash.js":"^1.1.7","lodash":"^4.17.15","minimist":"^1.2.0","moment":"^2.24.0","overmind":"^21.0.0","overmind-devtools":"^22.0.0","overmind-react":"^22.0.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-json-view":"^1.19.1","react-pdf":"https://github.com/cyrusbowman/react-pdf.git","react-scripts":"3.3.0","react-virtualized":"^9.21.2","semantic-ui-css":"^2.4.1","semantic-ui-react":"^0.88.2","superagent":"^5.2.1","typescript":"^3.8.3"},"scripts":{"predeploy":"yarn run build","deploy":"gh-pages -d build","start":"concurrently \\"overmind-devtools\\" \\"react-scripts start\\"","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},210:function(e,t){},507:function(e,t,a){e.exports=a(954)},534:function(e,t){},553:function(e,t){},555:function(e,t){},678:function(e,t){},679:function(e,t){},734:function(e,t){e.exports="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImRldjEiLCJqd2siOnsia3R5IjoiUlNBIiwibiI6InJyMzhpSzhGaTBfLUNSTFR2Vks0SUlDbGFyaWk2d1ZIcEU3elpQWG9FUmxfT29oNjRZbWJRY1JhNWVGdzBVUWhVdkVDaEt1OU5vM2ptN0xXOVpjTDFIS3Joa1VXLU9Rb2JPWFVuckNnb0NwYThWWWhfd1JJZFFZYnN2UFFWajVOR3V1TlhhWkJfX3B4Rnktbl9PMklNUzhPR3Jlem0zYlFIREFmLWpuZ0loWkdaZ0xhdkxKeVNIVXlEUUw0RmJRNkQzUXozQU1PcnhGdmE0S0JJUENRS0ZPbVlYVm40enRnVDY4aGd5TW9jMUt5dHhvUmd6VkhuQ2RUcFBXV1Zybk1GY0plZFlELUxtazBYbzVyallPeG1xOEExZWpmeFBNZVJfM1Y3OEFKazJMREk0dkdhSjNmbmFQWlM3Q3ZXOEYzcFdXaWpfQnlWR0NJLTVCcmtxSF9uUSIsImUiOiJBUUFCIn19.eyJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9vYXV0aDIvcmVkaXJlY3QuaHRtbCIsImh0dHBzOi8vdHJlbGxpc2Z3LmdpdGh1Yi5pby9jb25kdWN0b3Ivb2F1dGgyL3JlZGlyZWN0Lmh0bWwiXSwidG9rZW5fZW5kcG9pbnRfYXV0aF9tZXRob2QiOiJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Y2xpZW50LWFzc2VydGlvbi10eXBlOmp3dC1iZWFyZXIiLCJncmFudF90eXBlcyI6WyJhdXRob3JpemF0aW9uX2NvZGUiXSwicmVzcG9uc2VfdHlwZXMiOlsidG9rZW4iLCJjb2RlIiwiaWRfdG9rZW4iLCJpZF90b2tlbiB0b2tlbiIsImNvZGUgaWRfdG9rZW4iLCJjb2RlIHRva2VuIiwiY29kZSBpZF90b2tlbiB0b2tlbiJdLCJjbGllbnRfbmFtZSI6IlRyZWxsaXMgLSBPcGVuIFNvdXJjZSIsImNsaWVudF91cmkiOiJodHRwczovL2dpdGh1Yi5jb20vdHJlbGxpc2Z3IiwiY29udGFjdHMiOlsiQWFyb24gQXVsdCA8YXVsdGFjQHB1cmR1ZS5lZHU-Il0sImp3a3MiOnsia2V5cyI6W3sia3R5IjoiUlNBIiwibiI6InZ3dzFLcjNIVTk1MHBKTDhOeXh0MVZZN0ZIZTN6eHpSZ1VrZE1udDNCUzZGZ3h5cHZXR29YTWE5UFpYUHcxX3hiUVc1cFdJVU91ZG1Kek1MRnRZMzlrUVFiSW9WdDF1WV9JdEI0NmdrNTIzS0FRVktiQzQtVFgyT25WSGRJLWswY1FlTmZIakl0c0RjZE4tUFhKVlMtNzBEMFlhMEQzV3lpVEhPaHNkWXpXQm1iYUVwbDVEbkRrY0dCbjA4RXBMdzFlWWE4ejlxSHRlNE1Wc01jczJpdjdmeDZ0TTJmbVBlNFB5WUF4ZVJYU0RTMVdKcndReUs5SnJHMVBfQVF1X0xFQ2V6aUp0ZVk2RVZ1aVczbGI1WDhZOW9xM3FwNWV4SkNWWVJ2c3NRVXc1Ti1XdjhENUlpeTdBNmJMLUhKUDFfOWJ5OThSWTh4LVhiSzR6X0VMUjNNUSIsImUiOiJBUUFCIiwia2lkIjoiOTRhYWJiM2FhMTkxNGVjOGE4Y2RhNDU1YTQ3M2NmMGQifV19LCJpYXQiOjE1ODI2OTM5OTR9.NWYV4bi4FAFS6xchooCuZ8yxcVAYeGsZ7Bx5gHnN42-uFLLdbexhYw9f6BMTzES1TAxlKokJxxrFV5mYEMaiJrxS5BbIhz_QOw3i4kNiveLEhq7ljLe-7ivosrHEKgAtWEIFLuqfMX5_f3Nojc3HoN5Ze_oP6FoV7-4Lt2-i3yeaHR_d6u1EzrUWX8TFfqUv7Yu4mSrSLgwOIeUoT8drmBmcZCHPS3RykhWgAq4SUXyXetNx-u_SbP3R8VPk3bJXtVH6q7qzA9kQu0Jy-Gl6ah2ZqH8g2QSUY9rQSa7cGSEBOgFhtjZF9TR4tJ34RYR6vELtcgyG8DGODX5VySpr4Q"},735:function(e,t){e.exports={redirect_uris:["http://localhost:3000/oauth2/redirect.html","https://trellisfw.github.io/conductor/oauth2/redirect.html"],token_endpoint_auth_method:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",grant_types:["authorization_code"],response_types:["token","code","id_token","id_token token","code id_token","code token","code id_token token"],client_name:"Trellis - Open Source",client_uri:"https://github.com/trellisfw",contacts:["Aaron Ault <aultac@purdue.edu>"],jwks:{keys:[{kty:"RSA",n:"vww1Kr3HU950pJL8Nyxt1VY7FHe3zxzRgUkdMnt3BS6FgxypvWGoXMa9PZXPw1_xbQW5pWIUOudmJzMLFtY39kQQbIoVt1uY_ItB46gk523KAQVKbC4-TX2OnVHdI-k0cQeNfHjItsDcdN-PXJVS-70D0Ya0D3WyiTHOhsdYzWBmbaEpl5DnDkcGBn08EpLw1eYa8z9qHte4MVsMcs2iv7fx6tM2fmPe4PyYAxeRXSDS1WJrwQyK9JrG1P_AQu_LECeziJteY6EVuiW3lb5X8Y9oq3qp5exJCVYRvssQUw5N-Wv8D5Iiy7A6bL-HJP1_9by98RY8x-XbK4z_ELR3MQ",e:"AQAB",kid:"94aabb3aa1914ec8a8cda455a473cf0d"}]}}},788:function(e,t,a){},954:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"onInitialize",(function(){return M})),a.d(n,"state",(function(){return W})),a.d(n,"actions",(function(){return _}));var o={};a.r(o),a.d(o,"onInitialize",(function(){return G})),a.d(o,"state",(function(){return q})),a.d(o,"actions",(function(){return A})),a.d(o,"effects",(function(){return P}));var r={};a.r(r),a.d(r,"state",(function(){return $})),a.d(r,"actions",(function(){return ee}));var c={};a.r(c),a.d(c,"state",(function(){return te})),a.d(c,"actions",(function(){return ae}));var i=a(0),s=a.n(i),l=a(57),d=a.n(l),u=a(43),p=a(196),b=a(494),f=a(466),h=a(8),g=a.n(h),m={showData:!1,finished:!1,trellisMask:null,original:null,maskedResourceURL:null,maskedResourceURLVerify:null,originalHash:function(e,t){var a=e.original;if(a)return Object(f.hashJSON)(a).hash},valid:function(e,t){var a=e.originalHash,n=e.trellisMask,o=e.maskedResourceURLVerify;if(o){if(o.match&&o.unchanged)return!0}else{var r=g.a.get(n,"hashinfo.hash");if(a&&r&&a==r)return!0}return!1}},v=a(18),j=a.n(v),O=a(29),w=a.n(O),k=a(467),y=a.n(k),x=a(468),R=a.n(x),I={toggleShowData:function(e){var t=e.state;t.app.showData=!t.app.showData},processURL:function(e){var t,a,n,o,r,c,i,s,l,d,u,p,b,f,h,m,v;return j.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(t=e.state,a=e.actions,n=y.a.parse(window.location.search),o=n["trellis-mask"],r=n["masked-resource-url"],c=JSON.parse((Array.isArray(o)?o[0]:o)||"{}"),i=null,r?i=r:c&&c.url&&(i=c.url),!i){O.next=68;break}return t.app.trellisMask=c,t.app.maskedResourceURL=r,t.app.maskedResourceURLVerify=null,t.app.original=null,s=new URL(i),l=s.origin,d=s.pathname,a.login.domainChange({value:l}),O.next=14,j.a.awrap(a.login.login());case 14:if(!r){O.next=18;break}return O.next=17,j.a.awrap(R.a.verifyRemoteResource({url:i,token:t.oada.token}));case 17:t.app.maskedResourceURLVerify=O.sent;case 18:return O.prev=18,O.next=21,j.a.awrap(a.oada.get(d));case 21:if(!(u=O.sent).error){O.next=24;break}throw u.error;case 24:if(t.app.original=r?g.a.clone(t.app.maskedResourceURLVerify.original):u.data,p=d.match(/(\/resources\/[^\/]*)\/?(.*)/i),b=null,f=null,p&&(b=p[1],p[2].length>0&&(f=p[2])),t.app.resourcePath=f,null,null!=f){O.next=35;break}t.app.originalResource=g.a.clone(t.app.original),O.next=43;break;case 35:return O.next=37,j.a.awrap(a.oada.get("".concat(b)));case 37:if(h=O.sent,m=h.error,v=h.data,!m){O.next=42;break}throw m;case 42:t.app.originalResource=v;case 43:return O.next=45,j.a.awrap(a.oada.get("".concat(t.app.originalResource._meta._id,"/vdoc/_id")));case 45:if(!(u=O.sent).error){O.next=48;break}throw u.error;case 48:return console.log("GET","".concat(t.app.originalResource._id,"/_meta/vdoc/_id")),console.log("Response",u),t.app.documentId=u.data,O.next=53,j.a.awrap(a.oada.get(t.app.documentId));case 53:if(!(u=O.sent).error){O.next=56;break}throw u.error;case 56:t.app.document=u.data,f&&(t.view.Modals.VerifiedModal.open=!0),O.next=66;break;case 60:if(O.prev=60,O.t0=O.catch(18),O.t0.response){O.next=64;break}throw O.t0;case 64:403==g.a.get(O.t0,"response.status")?t.app.errorMessage="You do not have access to the original data.":404==g.a.get(O.t0,"response.status")?t.app.errorMessage="The original no longer exists at this location.":t.app.errorMessage="Opps! A unknown error occured.",t.app.error=!0;case 66:O.next=70;break;case 68:t.app.errorMessage="Oops! A valid link must be provided to application.",t.app.error=!0;case 70:t.app.finished=!0;case 71:case"end":return O.stop()}}),null,null,[[18,60]])}},V=a(203);var M=function(e){var t;return j.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.state,t=e.actions,e.effects,console.log("Started app"),V&&V.version&&(document.title=document.title+" - v"+V.version),a.next=5,j.a.awrap(t.app.processURL());case 5:case"end":return a.stop()}}))},W=m,_=I,C={oada:{url:"https://stage.smithfield.trellis.one",devcert:a(734),redirect:a(735).redirect_uris[1]}},S=g.a.merge({},C,null),F={url:S.oada.url,token:"",data:{documents:{}}},T=a(197),U=a.n(T),z=a(469),E=w.a.promisify(z.browser.getAccessToken),N=function(e){return"oada:"+e+":token"},Y={logout:function(e){var t,a;return j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,a=e.effects,n.next=3,j.a.awrap(a.oada.websocket.close());case 3:t.oada.data.documents={},delete window.localStorage[N(t.oada.url)];case 5:case"end":return n.stop()}}))},login:function(e){var t=e.state,a=e.actions;return w.a.try((function(){return window.localStorage[N(t.oada.url)]?(console.log("Already have a token for URL "+t.oada.url+", logout to clear"),window.localStorage[N(t.oada.url)]):(console.log("Do not have an access token, redirecting..."),E(t.oada.url.replace(/^https?:\/\//,""),{metadata:S.oada.devcert,scope:"all:all",redirect:S.oada.redirect}).then((function(e){return e.access_token})).catch((function(e){return t.login.error="Failed to redirect to "+t.oada.url+" for connection",console.log("FAILED TO GET ACCESS TOKEN: err = ",e),!1})))})).then((function(e){return e&&(window.localStorage[N(t.oada.url)]=e),t.oada.token=e,console.log("Have token, connecting to oada..."),a.oada.connect()})).then((function(e){console.log("Websocket connected.")}))},uploadFile:function(e,t){var a=e.state,n=e.actions;return U.a.request({url:"/resources",method:"post",baseURL:a.oada.url,headers:{Authorization:"Bearer "+a.oada.token,"Content-Disposition":"inline","Content-Type":t.type},data:t}).then((function(e){var a=e.headers["content-location"].split("/");return a=a[a.length-1],n.oada.put({url:"/resources/".concat(a,"/_meta"),data:{filename:t.name},headers:{"Content-Type":"application/json"}}).then((function(){return n.oada.createAndPostResource({url:"/bookmarks/trellisfw/documents",data:{pdf:{_id:"resources/"+a,_rev:0}}})}))}))},onDocumentsChange:function(e,t){var a=e.state,n=e.actions;if(console.log("onDocumentsChange",t),"merge"==g.a.get(t,"change.type")){var o=g.a.filter(Object.keys(g.a.get(t,"change.body")),(function(e){return!1===g.a.startsWith(e,"_")}));return w.a.map(o,(function(e){return n.oada.loadDocument(e)}))}if("delete"==g.a.get(t,"change.type")){var r=g.a.filter(Object.keys(g.a.get(t,"change.body")),(function(e){return!1===g.a.startsWith(e,"_")}));g.a.forEach(r,(function(e){delete a.oada.data.documents[e]}))}},loadDocument:function(e,t){var a=e.state,n=e.actions;return n.oada.get("/bookmarks/trellisfw/documents/"+t).then((function(e){var o=a.oada.data.documents[t]||{};return a.oada.data.documents[t]=g.a.merge({},o,e.data),n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/_meta")).then((function(e){if(null==e)throw Error("No data");var n=a.oada.data.documents[t]._meta;a.oada.data.documents[t]._meta=g.a.merge({},n,g.a.pick(e.data,["stats","services"]))})).catch((function(e){console.log("Error. Failed to load document _meta",t)})).then((function(){if(null!=a.oada.data.documents[t].pdf)return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/pdf/_meta")).then((function(e){if(null==e)throw Error("No data");var n=a.oada.data.documents[t].pdf._meta||{};a.oada.data.documents[t].pdf._meta=g.a.merge({},n,g.a.pick(e.data,["filename"]))})).catch((function(e){console.log("Error. Failed to load pdf _meta",t)}))})).then((function(){if(null!=a.oada.data.documents[t].audits)return w.a.map(g.a.keys(a.oada.data.documents[t].audits),(function(e){return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/audits/").concat(e)).then((function(n){if(null==n)throw Error("No data");var o=a.oada.data.documents[t].audits[e]||{};a.oada.data.documents[t].audits[e]=g.a.merge({},o,n.data)})).catch((function(a){console.log("Error. Failed to load audit ",e,"from doc",t)}))}))})).then((function(){if(null!=a.oada.data.documents[t]["audits-masked"])return w.a.map(g.a.keys(a.oada.data.documents[t]["audits-masked"]),(function(e){return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/audits-masked/").concat(e)).then((function(n){if(null==n)throw Error("No data");var o=a.oada.data.documents[t]["audits-masked"][e]||{};a.oada.data.documents[t]["audits-masked"][e]=g.a.merge({},o,n.data)})).catch((function(a){console.log("Error. Failed to load audit ",e,"from doc",t)}))}))})).then((function(){if(null!=a.oada.data.documents[t].cois)return w.a.map(g.a.keys(a.oada.data.documents[t].cois),(function(e){return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/cois/").concat(e)).then((function(n){if(null==n)throw Error("No data");var o=a.oada.data.documents[t].cois[e]||{};a.oada.data.documents[t].cois[e]=g.a.merge({},o,n.data)})).catch((function(a){console.log("Error. Failed to load coi ",e,"from doc",t)}))}))}))})).catch((function(e){console.log("Error. Failed to load document",t,e)}))},createAndPostResource:function(e,t){var a=e.actions,n=t.url,o=t.data,r=t.contentType;return a.oada.createResource({data:o,contentType:r}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1],a.oada.post({url:n,headers:{"Content-Type":r||"application/json"},data:{_id:"resources/"+t,_rev:0}}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1]}))}))},createAndPostResourceHTTP:function(e,t){var a=e.actions,n=t.url,o=t.data,r=t.contentType;return a.oada.createResourceHTTP({data:o,contentType:r}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1],a.oada.postHTTP({url:n,headers:{"Content-Type":r||"application/json"},data:{_id:"resources/"+t,_rev:0}}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1]}))}))},createAndPutResource:function(e,t){var a=e.actions,n=t.url,o=t.data,r=t.contentType;return a.oada.createResource({data:o,contentType:r}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1],a.oada.put({url:n,headers:{"Content-Type":r||"application/json"},data:{_id:"resources/"+t,_rev:0}})}))},createResource:function(e,t){var a=e.actions,n=t.data,o=t.contentType,r={};return r["content-type"]=o||"application/json",a.oada.post({url:"/resources",data:n,headers:r})},createResourceHTTP:function(e,t){var a=e.actions,n=t.data,o=t.contentType,r={};return r["content-type"]=o||"application/json",a.oada.postHTTP({url:"/resources",data:n,headers:r})},doesResourceExist:function(e,t){return e.actions.oada.head(t).then((function(e){return null!=e})).catch((function(e){if(e.response&&404===e.response.status)return!1;throw e}))},connect:function(e){var t=e.state;return e.effects.oada.websocket.connect(t.oada.url)},get:function(e,t){var a=e.effects,n=e.state;return a.oada.websocket.http({method:"GET",url:t,headers:{Authorization:"Bearer "+n.oada.token}})},head:function(e,t){var a=e.effects,n=e.state;return a.oada.websocket.http({method:"HEAD",url:t,headers:{Authorization:"Bearer "+n.oada.token}})},post:function(e,t){var a=e.effects,n=e.state,o=t.url,r=t.headers,c=t.data;return console.log("Posting to url ",o),a.oada.websocket.http({method:"POST",url:o,headers:g.a.merge({Authorization:"Bearer "+n.oada.token},r),data:c})},postHTTP:function(e,t){e.effects;var a=e.state,n=t.url,o=t.headers,r=t.data;return U.a.request({url:n,method:"post",baseURL:a.oada.url,headers:g.a.merge({Authorization:"Bearer "+a.oada.token},o),data:r})},put:function(e,t){var a=e.effects,n=e.state,o=t.url,r=t.headers,c=t.data;return a.oada.websocket.http({method:"PUT",url:o,headers:g.a.merge({Authorization:"Bearer "+n.oada.token},r),data:c})},watch:function(e,t){var a=e.effects,n=e.actions,o=e.state,r=t.url,c=t.actionName;return a.oada.websocket.watch({url:r,headers:{Authorization:"Bearer "+o.oada.token}},(function(e){g.a.get(n,c)(e)}))}},D=a(204),J=a(15),L=a(121),Z=a(29),B=a(54),H=a(102);Z.config({warnings:!1});var X=null,G=function(e,t){e.state,e.actions,e.effects},q=F,A=Y,P={websocket:{connect:function(e){return function(e){var t,a=[];e=e.replace("https://","wss://").replace("http://","ws://"),console.log("Creating WebSocket for",e);var n=!1,o={},r={};function c(){n&&(a.forEach((function(e){t.send(JSON.stringify(e))})),a=[])}return new Z((function(a,i){console.log("Calling WebSocket(url)"),(t=new WebSocket(e)).onopen=function(e){console.log("We are connected via websocket"),n=!0,c(),a(t)},t.onclose=function(e){console.log("Websocket closed.")},t.onmessage=function(e){var t=JSON.parse(e.data);if(t.requestId)if(o[t.requestId]){if(t.status>=200&&t.status<300)o[t.requestId].resolve(t);else{var a=new Error("Request failed with status code "+t.status);a.request=o[t.requestId].request,a.response={status:t.status,statusText:t.statusText,headers:t.headers,data:t.data},a.originalStack=o[t.requestId].request.requestStack,o[t.requestId].reject(a)}delete o[t.requestId]}else if(r[t.requestId])if(r[t.requestId].resolve){if("success"===t.status)r[t.requestId].resolve(t);else{var n=new Error("Request failed with status code "+t.status);n.response=t,n.request=r[t.requestId].request,r[t.requestId].reject(n)}delete r[t.requestId].resolve,delete r[t.requestId].reject}else{if(null==r[t.requestId].callback)throw new Error("The given watch function has an undefined callback:",r[t.requestId]);r[t.requestId].callback(t)}}})).then((function(){return console.log("Returning websocket obj"),{url:e,http:function(e){return new Z((function(t,n){var r=B.parse(e.url),i={requestId:H(),method:e.method.toLowerCase(),path:r.path,data:e.data,headers:Object.entries(e.headers).map((function(e){var t=Object(L.a)(e,2),a=t[0],n=t[1];return Object(J.a)({},a.toLowerCase(),n)})).reduce((function(e,t){return Object(D.a)({},e,{},t)}))};a.push(i),o[i.requestId]={request:e,resolve:t,reject:n},c()}))},close:function(){a=[],o={},r={},t.close()},watch:function(e,t){var n=B.parse(e.url);return new Z((function(o,i){var s={requestId:H(),method:"watch",path:n.path,headers:Object.entries(e.headers).map((function(e){var t=Object(L.a)(e,2),a=t[0],n=t[1];return Object(J.a)({},a.toLowerCase(),n)})).reduce((function(e,t){return Object(D.a)({},e,{},t)}))};a.push(s),r[s.requestId]={request:e,resolve:o,reject:i,callback:t},c()}))},unwatch:function(e,t){var n=B.parse(e.url);return new Z((function(o,i){var s={requestId:H(),method:"unwatch",path:n.path,headers:Object.entries(e.headers).map((function(e){var t=Object(L.a)(e,2),a=t[0],n=t[1];return Object(J.a)({},a.toLowerCase(),n)})).reduce((function(e,t){return Object(D.a)({},e,{},t)}))};a.push(s),r[s.requestId]={request:e,resolve:o,reject:i,callback:t},c()}))}}}))}(e).then((function(e){X=e}))},watch:function(e,t){return X.watch(e,t)},http:function(e){return X.http(e).catch((function(e){return e.response&&e.response.status?404==e.response.status?(console.log("HTTP 404",g.a.get(e,"response.headers.content-location")),{error:e}):403==e.response.status?(console.log("HTTP 403",g.a.get(e,"response.headers.content-location")),{error:e}):(console.log("HTTP Error: ",e),{error:e}):(console.log("HTTP Error",e),{error:e})}))},close:function(){if(X)return console.log("Closing web socket..."),X.close();console.log("WARNING: tried to close a null websocket!")}}},Q=a(205),K={Pages:{selectedPage:"Data",Data:{search:"",openFileBrowser:!1,uploading:{}}},Modals:{VerifiedModal:{open:!1,showData:!1,data:function(e,t){return Object(Q.a)(e),t.app.original},path:function(e,t){return Object(Q.a)(e),t.app.resourcePath},type:function(e,t){Object(Q.a)(e);var a=g.a.get(t,"app.originalResource._type");return"application/vnd.trellisfw.audit.sqfi.1+json"==a?"audit":"application/vnd.trellisfw.coi.accord+json"==a?"coi":void 0}}}},$=(a(102),K),ee={TopBar:{logout:function(e){e.state;var t=e.actions;t.login.logout(),t.oada.logout()}},Modals:{VerifiedModal:{toggleShowData:function(e,t){var a=e.state;a.view.Modals.VerifiedModal.showData=!a.view.Modals.VerifiedModal.showData},close:function(e){var t=e.state;e.actions;t.view.Modals.VerifiedModal.open=!1}}}},te={domain:S.oada&&S.oada.url?S.oada.url:""},ae={login:function(e){var t,a,n;return j.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.state,a=e.actions,t.login.loading=!0,t.oada.url=t.login.domain.match(/^http/)?t.login.domain:"https://"+t.login.domain,o.next=5,j.a.awrap(a.oada.login());case 5:if(t.login.loading=!1,!t.oada.token){o.next=12;break}return t.login.loggedIn=!0,o.next=10,j.a.awrap(a.oada.get("/users/me"));case 10:n=o.sent,t.login.name=n&&n.data&&n.data.username;case 12:case"end":return o.stop()}}))},logout:function(e){var t,a;return j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,a=e.actions,n.next=3,j.a.awrap(a.oada.logout());case 3:return t.login.loggedIn=!1,t.app.finished=!1,n.next=7,j.a.awrap(a.app.processURL());case 7:case"end":return n.stop()}}))},domainChange:function(e,t){e.state.login.domain=t.value}},ne=Object(b.a)({app:n,oada:o,view:r,login:c}),oe=Object(p.b)(),re=(a(788),a(4)),ce=a(982);var ie=function(){var e=oe(),t=e.actions,a=e.state;return a.app.skin,Object(re.b)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#fff",minHeight:"85px",borderBottom:"1px solid #979797"}},Object(re.b)("img",{css:{height:"70px",paddingLeft:"20px"},src:"logo.svg",alt:"logo"}),Object(re.b)("div",{css:{marginRight:50}},Object(re.b)(ce.a,{text:a.login.name},Object(re.b)(ce.a.Menu,null,Object(re.b)(ce.a.Item,{icon:"power",text:"Logout",value:"logout",onClick:t.view.TopBar.logout})))))},se=a(983);var le=function(e){var t=e.coi,a=t.producer&&t.producer.name?t.producer.name:"Unknown";return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Producer"),Object(re.b)(se.a.Cell,null,a))};var de=function(e){var t=e.coi,a=t.holder&&t.holder.name?t.holder.name:"Unknown";return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Holder"),Object(re.b)(se.a.Cell,null,a))},ue=a(98),pe=a(72),be=a.n(pe),fe=a(978),he=a(981);function ge(){var e=Object(ue.a)(["\n          .MuiChip-root {\n            font-family: inherit;\n            font-size: 14px;\n            line-height: 16px;\n            margin-left: 3px;\n            margin-top: 3px;\n          }\n          .MuiChip-root:first-of-type {\n            margin-left: 0px;\n          }\n        "]);return ge=function(){return e},e}var me=function(e){var t=e.coi,a=g.a.cloneDeep(t.policies)||[];return a=g.a.filter(a,(function(e){if(e.start=be()(e.effective_date),e.end=be()(e.expire_date),!e.start.isValid())return!1;if(!e.end.isValid())return!1;var t=be()();return e.expired=e.start.isAfter(t)||e.end.isBefore(t),!0})),Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Policies"),Object(re.b)(se.a.Cell,{css:Object(re.a)(ge())},g.a.map(a,(function(e,t){return Object(re.b)(he.a,{key:t,content:Object(re.b)("div",null,Object(re.b)("div",{css:{textAlign:"center"}},"Effective"),Object(re.b)("div",null,"".concat(e.start.format("MMMM d, YYYY")," to ").concat(e.end.format("MMMM d, YYYY")))),trigger:Object(re.b)(fe.a,{color:e.expired?"secondary":"default",label:"".concat(e.number).concat(e.expired?": EXPIRED":"")})})}))))};var ve=function(e){var t=e.coi;return e.document,Object(re.b)(se.a,{celled:!0,striped:!0,css:{maxWidth:800}},Object(re.b)(se.a.Body,{css:{fontSize:16}},Object(re.b)(le,{coi:t}),Object(re.b)(de,{coi:t}),Object(re.b)(me,{coi:t})))};var je=function(e){var t=e.audit,a=t.organization&&t.organization.name?t.organization.name:"Unknown";return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Organization"),Object(re.b)(se.a.Cell,null,a))};function Oe(){var e=Object(ue.a)(["\n          .MuiChip-root {\n            font-family: inherit;\n            font-size: 14px;\n            line-height: 16px;\n            margin-left: 3px;\n            margin-top: 3px;\n          }\n          .MuiChip-root:first-of-type {\n            margin-left: 0px;\n          }\n        "]);return Oe=function(){return e},e}var we=function(e){var t=e.audit;return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Scope (Products)"),Object(re.b)(se.a.Cell,{css:Object(re.a)(Oe())},g.a.map(t.scope.products_observed,(function(e,t){return Object(re.b)(fe.a,{key:t,label:e.name})}))))};var ke=function(e){var t=e.audit;return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Score"),Object(re.b)(se.a.Cell,null,"".concat(t.score.final.value," "),t.score.rating?Object(re.b)("span",{style:{color:t.score.rating.match(/(good|excellent)/i)?"green":"red"}},"(",t.score.rating.trim(),")"):""))};var ye=function(e){var t=e.audit,a=null;if(t.certificate_validity_period&&t.certificate_validity_period.start&&t.certificate_validity_period.end){(a={start:be()(t.certificate_validity_period.start,"M/D/YYYY"),end:be()(t.certificate_validity_period.end,"M/D/YYYY")}).start&&a.start.isValid()||(a=null),a.end&&a.end.isValid()||(a=null);var n=be()();a.expired=a.start.isAfter(n)||a.end.isBefore(n)}return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Validity"),Object(re.b)(se.a.Cell,null,a?a.expired?Object(re.b)("span",{style:{color:"red"}},"EXPIRED!"):Object(re.b)("span",{style:{color:"green"}},"VALID (from ".concat(a.start.format("MMM d, YYYY")," to ").concat(a.end.format("MMM d, YYYY"),")")):""))};var xe=function(e){var t=e.audit;return Object(re.b)(se.a,{celled:!0,striped:!0,css:{maxWidth:800}},Object(re.b)(se.a.Body,{css:{fontSize:16}},Object(re.b)(je,{audit:t}),Object(re.b)(ke,{audit:t}),Object(re.b)(we,{audit:t}),Object(re.b)(ye,{audit:t})))},Re=a(284);var Ie=function(e){var t=e.oada,a=e.path,n={Authorization:"Bearer "+t.token},o="".concat(t.url,"/").concat(a);return Object(re.b)("div",null,Object(re.b)(Re.a,{file:{url:o,httpHeaders:n},onLoadSuccess:function(e){e.numPages}},Object(re.b)(Re.b,{className:"pdfPage",pageNumber:1,width:900})))},Ve=a(200),Me=a.n(Ve),We=a(984);var _e=function(){var e=oe(),t=e.actions,a=e.state,n=a.app.originalResource||{},o=a.app.document||{},r=null;return n&&((r=g.a.cloneDeep(n))._id&&delete r._id,r._rev&&delete r._rev,r._type&&delete r._type,r._meta&&delete r._meta),Object(re.b)("div",{css:{display:"flex",flexDirection:"column",flex:"1",boxShadow:"inset 5px 5px 5px #dddddd",padding:10,alignItems:"center"}},Object(re.b)("div",{css:{height:20}}),a.app.maskedResourceURLVerify?a.app.valid?Object(re.b)("div",{css:{fontSize:25,color:"green"}},"Integrity of document verified."):Object(re.b)("div",{css:{fontSize:25,color:"red"}},"Could not verify document integrity."):null,Object(re.b)("div",{css:{height:10}}),"application/vnd.trellisfw.audit.sqfi.1+json"==n._type?Object(re.b)(xe,{audit:n}):null,"application/vnd.trellisfw.coi.accord+json"==n._type?Object(re.b)(ve,{coi:n}):null,o.pdf?Object(re.b)(Ie,{oada:a.oada,path:"".concat(a.app.documentId,"/pdf")}):null,a.app.showData?Object(re.b)(Me.a,{src:r,name:"data",collapsed:1,collapseStringsAfterLength:50,displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1}):null,Object(re.b)(We.a,{onClick:function(){t.app.toggleShowData()}},a.app.showData?"Hide Data":"View Data"))},Ce=a(979),Se=a(985),Fe=a(122);var Te=function(e){var t=oe(),a=t.state,n=t.actions,o=(a.view.Modals.VerifiedModal,n.view.Modals.VerifiedModal);return Object(re.b)(Se.a,null,Object(re.b)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"center"}},a.app.valid?Object(re.b)("div",{css:{fontSize:25,color:"green"}},"Data Integrity Verified"):Object(re.b)("div",{css:{fontSize:25,color:"red"}},"WARNING: Could not verify data integrity!"),Object(re.b)(We.a,{icon:!0,onClick:function(){return o.close()}},Object(re.b)(Fe.a,{name:"x"}))))};var Ue=function(e){var t=e.data;return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Organization Location"),Object(re.b)(se.a.Cell,null,Object(re.b)("div",null,t.street_address),Object(re.b)("div",null,"".concat(t.city,", ").concat(t.state," ").concat(t.postal_code)),Object(re.b)("div",null,t.country)))};var ze=function(e){var t=e.data;return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Scope Operation Location"),Object(re.b)(se.a.Cell,null,Object(re.b)("div",null,t.address),Object(re.b)("div",null,"".concat(t.city,", ").concat(t.state," ").concat(t.postal_code)),Object(re.b)("div",null,t.country)))};var Ee=function(e){var t=e.data,a=e.path;return Object(re.b)(se.a,{definition:!0},Object(re.b)(se.a.Body,{css:{fontSize:16}},"organization/location"==a?Object(re.b)(Ue,{data:t}):null,"scope/operation/location"==a?Object(re.b)(ze,{data:t}):null))};var Ne=function(e){var t=e.data,a=e.title;return Object(re.b)(se.a.Row,null,Object(re.b)(se.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},a),Object(re.b)(se.a.Cell,null,Object(re.b)("div",null,t.street_address),Object(re.b)("div",null,"".concat(t.city,", ").concat(t.state," ").concat(t.postal_code)),Object(re.b)("div",null,t.country)))};var Ye=function(e){var t=e.data,a=e.path;return Object(re.b)(se.a,{definition:!0},Object(re.b)(se.a.Body,{css:{fontSize:16}},"producer/location"==a?Object(re.b)(Ne,{title:"Producer Location",data:t}):null,"holder/location"==a?Object(re.b)(Ne,{title:"Holder Location",data:t}):null,"insured/location"==a?Object(re.b)(Ne,{title:"Insured Location",data:t}):null))};var De=function(e){var t=oe(),a=t.actions,n=t.state,o=a.view.Modals.VerifiedModal,r=n.view.Modals.VerifiedModal,c=null,i=r.path;return r.data&&((c=g.a.cloneDeep(r.data))._id&&delete c._id,c._rev&&delete c._rev,c._type&&delete c._type,c._meta&&delete c._meta),Object(re.b)("div",null,Object(re.b)("div",{css:{color:"#2439FF",fontSize:16,marginBottom:7,display:"flex",flexDirection:"column",alignItems:"center"}},"audit"==r.type?Object(re.b)(Ee,{data:r.data,path:r.path}):null,"coi"==r.type?Object(re.b)(Ye,{data:r.data,path:r.path}):null,r.showData?null==c?Object(re.b)("span",null,"< No Data >"):Object(re.b)(Me.a,{src:c,name:i,collapsed:1,collapseStringsAfterLength:50,displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1}):"",Object(re.b)("div",{css:{display:"flex"}},Object(re.b)(We.a,{onClick:function(){o.toggleShowData(g.a.get(r,"documentKey"))}},r.showData?"Hide Data":"View Data"),Object(re.b)("div",{css:{width:40}}),Object(re.b)(We.a,{onClick:function(){o.close()}},"Close"))))};var Je=function(e){var t=oe(),a=t.actions,n=t.state,o=a.view.Modals.VerifiedModal,r=n.view.Modals.VerifiedModal;return Object(re.b)(Ce.a,{open:r.open,onClose:o.close},Object(re.b)(Te,null),Object(re.b)(Ce.a.Content,null,Object(re.b)("div",{css:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},Object(re.b)(De,null))))};a(953);function Le(){var e=Object(ue.a)(["\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        font-size: 1.2em;\n        color: #FFFFFF;\n        cursor: pointer;\n      "]);return Le=function(){return e},e}function Ze(){var e=Object(ue.a)(["\n      height: 100vh;\n      width: 100vw;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n    "]);return Ze=function(){return e},e}var Be=function(){var e=oe(),t=e.state,a=e.actions,n=(t.app,t.login,a.login);return Object(re.b)("div",{css:Object(re.a)(Ze())},Object(re.b)("img",{css:{height:100,marginBottom:25},src:"logo.svg",alt:"logo"}),Object(re.b)("img",{css:{height:100,marginBottom:25},src:"magnify.svg",alt:"logo"}),Object(re.b)("div",{css:{fontSize:20,paddingBottom:100}},"Verifying your data..."),Object(re.b)("a",{css:Object(re.a)(Le()),onClick:n.logout},"Logout"))};var He=function(){var e=oe(),t=e.state;return e.actions,t.app.finished?Object(re.b)("div",{css:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",justifyContent:"stretch"}},Object(re.b)(ie,null),Object(re.b)("div",{css:{flex:1,display:"flex",flexDirection:"row",alignItems:"stretch"}},Object(re.b)(_e,null),Object(re.b)(Je,null))):Object(re.b)(Be,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Xe=Object(u.c)(ne,{devtools:!0});d.a.render(s.a.createElement(p.a,{value:Xe},s.a.createElement(He,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[507,1,2]]]);
//# sourceMappingURL=main.1c53e9f7.chunk.js.map