(this.webpackJsonpreagan=this.webpackJsonpreagan||[]).push([[0],{203:function(e){e.exports=JSON.parse('{"name":"reagan","version":"0.1.4","private":true,"homepage":"https://trellisfw.github.io/reagan/","dependencies":{"@emotion/core":"^10.0.27","@material-ui/core":"^4.9.7","@oada/oada-id-client":"^1.0.4","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.3.2","@testing-library/user-event":"^7.1.2","@trellisfw/masklink":"^1.0.4","@trellisfw/signatures":"^2.1.0","@types/jest":"^25.1.4","@types/node":"^13.9.0","@types/react":"^16.9.23","@types/react-dom":"^16.9.5","addressbar":"^1.0.3","axios":"^0.19.2","bluebird":"^3.7.2","classnames":"^2.2.6","concurrently":"^5.1.0","fuse.js":"^5.0.7-beta","gh-pages":"^2.2.0","hash.js":"^1.1.7","lodash":"^4.17.15","minimist":"^1.2.0","moment":"^2.24.0","overmind":"^21.0.0","overmind-devtools":"^22.0.0","overmind-react":"^22.0.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-json-view":"^1.19.1","react-pdf":"https://github.com/cyrusbowman/react-pdf.git","react-scripts":"3.3.0","react-virtualized":"^9.21.2","semantic-ui-css":"^2.4.1","semantic-ui-react":"^0.88.2","superagent":"^5.2.1","typescript":"^3.8.3"},"scripts":{"predeploy":"yarn run build","deploy":"gh-pages -d build","start":"concurrently \\"overmind-devtools\\" \\"react-scripts start\\"","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},210:function(e,t){},506:function(e,t,a){e.exports=a(954)},534:function(e,t){},553:function(e,t){},555:function(e,t){},678:function(e,t){},679:function(e,t){},734:function(e,t){e.exports="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImRldjEiLCJqd2siOnsia3R5IjoiUlNBIiwibiI6InJyMzhpSzhGaTBfLUNSTFR2Vks0SUlDbGFyaWk2d1ZIcEU3elpQWG9FUmxfT29oNjRZbWJRY1JhNWVGdzBVUWhVdkVDaEt1OU5vM2ptN0xXOVpjTDFIS3Joa1VXLU9Rb2JPWFVuckNnb0NwYThWWWhfd1JJZFFZYnN2UFFWajVOR3V1TlhhWkJfX3B4Rnktbl9PMklNUzhPR3Jlem0zYlFIREFmLWpuZ0loWkdaZ0xhdkxKeVNIVXlEUUw0RmJRNkQzUXozQU1PcnhGdmE0S0JJUENRS0ZPbVlYVm40enRnVDY4aGd5TW9jMUt5dHhvUmd6VkhuQ2RUcFBXV1Zybk1GY0plZFlELUxtazBYbzVyallPeG1xOEExZWpmeFBNZVJfM1Y3OEFKazJMREk0dkdhSjNmbmFQWlM3Q3ZXOEYzcFdXaWpfQnlWR0NJLTVCcmtxSF9uUSIsImUiOiJBUUFCIn19.eyJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9vYXV0aDIvcmVkaXJlY3QuaHRtbCIsImh0dHBzOi8vdHJlbGxpc2Z3LmdpdGh1Yi5pby9jb25kdWN0b3Ivb2F1dGgyL3JlZGlyZWN0Lmh0bWwiXSwidG9rZW5fZW5kcG9pbnRfYXV0aF9tZXRob2QiOiJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Y2xpZW50LWFzc2VydGlvbi10eXBlOmp3dC1iZWFyZXIiLCJncmFudF90eXBlcyI6WyJhdXRob3JpemF0aW9uX2NvZGUiXSwicmVzcG9uc2VfdHlwZXMiOlsidG9rZW4iLCJjb2RlIiwiaWRfdG9rZW4iLCJpZF90b2tlbiB0b2tlbiIsImNvZGUgaWRfdG9rZW4iLCJjb2RlIHRva2VuIiwiY29kZSBpZF90b2tlbiB0b2tlbiJdLCJjbGllbnRfbmFtZSI6IlRyZWxsaXMgLSBPcGVuIFNvdXJjZSIsImNsaWVudF91cmkiOiJodHRwczovL2dpdGh1Yi5jb20vdHJlbGxpc2Z3IiwiY29udGFjdHMiOlsiQWFyb24gQXVsdCA8YXVsdGFjQHB1cmR1ZS5lZHU-Il0sImp3a3MiOnsia2V5cyI6W3sia3R5IjoiUlNBIiwibiI6InZ3dzFLcjNIVTk1MHBKTDhOeXh0MVZZN0ZIZTN6eHpSZ1VrZE1udDNCUzZGZ3h5cHZXR29YTWE5UFpYUHcxX3hiUVc1cFdJVU91ZG1Kek1MRnRZMzlrUVFiSW9WdDF1WV9JdEI0NmdrNTIzS0FRVktiQzQtVFgyT25WSGRJLWswY1FlTmZIakl0c0RjZE4tUFhKVlMtNzBEMFlhMEQzV3lpVEhPaHNkWXpXQm1iYUVwbDVEbkRrY0dCbjA4RXBMdzFlWWE4ejlxSHRlNE1Wc01jczJpdjdmeDZ0TTJmbVBlNFB5WUF4ZVJYU0RTMVdKcndReUs5SnJHMVBfQVF1X0xFQ2V6aUp0ZVk2RVZ1aVczbGI1WDhZOW9xM3FwNWV4SkNWWVJ2c3NRVXc1Ti1XdjhENUlpeTdBNmJMLUhKUDFfOWJ5OThSWTh4LVhiSzR6X0VMUjNNUSIsImUiOiJBUUFCIiwia2lkIjoiOTRhYWJiM2FhMTkxNGVjOGE4Y2RhNDU1YTQ3M2NmMGQifV19LCJpYXQiOjE1ODI2OTM5OTR9.NWYV4bi4FAFS6xchooCuZ8yxcVAYeGsZ7Bx5gHnN42-uFLLdbexhYw9f6BMTzES1TAxlKokJxxrFV5mYEMaiJrxS5BbIhz_QOw3i4kNiveLEhq7ljLe-7ivosrHEKgAtWEIFLuqfMX5_f3Nojc3HoN5Ze_oP6FoV7-4Lt2-i3yeaHR_d6u1EzrUWX8TFfqUv7Yu4mSrSLgwOIeUoT8drmBmcZCHPS3RykhWgAq4SUXyXetNx-u_SbP3R8VPk3bJXtVH6q7qzA9kQu0Jy-Gl6ah2ZqH8g2QSUY9rQSa7cGSEBOgFhtjZF9TR4tJ34RYR6vELtcgyG8DGODX5VySpr4Q"},735:function(e,t){e.exports={redirect_uris:["http://localhost:3000/oauth2/redirect.html","https://trellisfw.github.io/conductor/oauth2/redirect.html"],token_endpoint_auth_method:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",grant_types:["authorization_code"],response_types:["token","code","id_token","id_token token","code id_token","code token","code id_token token"],client_name:"Trellis - Open Source",client_uri:"https://github.com/trellisfw",contacts:["Aaron Ault <aultac@purdue.edu>"],jwks:{keys:[{kty:"RSA",n:"vww1Kr3HU950pJL8Nyxt1VY7FHe3zxzRgUkdMnt3BS6FgxypvWGoXMa9PZXPw1_xbQW5pWIUOudmJzMLFtY39kQQbIoVt1uY_ItB46gk523KAQVKbC4-TX2OnVHdI-k0cQeNfHjItsDcdN-PXJVS-70D0Ya0D3WyiTHOhsdYzWBmbaEpl5DnDkcGBn08EpLw1eYa8z9qHte4MVsMcs2iv7fx6tM2fmPe4PyYAxeRXSDS1WJrwQyK9JrG1P_AQu_LECeziJteY6EVuiW3lb5X8Y9oq3qp5exJCVYRvssQUw5N-Wv8D5Iiy7A6bL-HJP1_9by98RY8x-XbK4z_ELR3MQ",e:"AQAB",kid:"94aabb3aa1914ec8a8cda455a473cf0d"}]}}},788:function(e,t,a){},954:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"onInitialize",(function(){return R})),a.d(n,"state",(function(){return V})),a.d(n,"actions",(function(){return M}));var o={};a.r(o),a.d(o,"onInitialize",(function(){return X})),a.d(o,"state",(function(){return H})),a.d(o,"actions",(function(){return q})),a.d(o,"effects",(function(){return G}));var r={};a.r(r),a.d(r,"state",(function(){return Q})),a.d(r,"actions",(function(){return K}));var c={};a.r(c),a.d(c,"state",(function(){return $})),a.d(c,"actions",(function(){return ee}));var i=a(0),s=a.n(i),l=a(57),d=a.n(l),u=a(43),p=a(196),b=a(493),f=(a(511),a(8)),h=a.n(f),g=a(18),m=a.n(g),v=a(29),j=a.n(v),O=a(467),w=a.n(O),y=a(277),k=a.n(y),x={toggleShowData:function(e){var t=e.state;t.app.showData=!t.app.showData},processURL:function(e){var t,a,n,o,r,c,i,s,l,d,u,p,b,f,g,v,j;return m.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if(t=e.state,a=e.actions,n=w.a.parse(window.location.search),o=n["trellis-mask"],r=n["masked-resource-url"],c=JSON.parse((Array.isArray(o)?o[0]:o)||"{}"),i=null,r?i=r:c&&c.url&&(i=c.url),!i){O.next=67;break}return t.app.trellisMask=null,t.app.maskedResourceURL=null,t.app.trellisMask=c,t.app.maskedResourceURL=r,t.app.original=null,t.app.originalVdoc=null,s=new URL(i),l=s.origin,d=s.pathname,a.login.domainChange({value:l}),O.next=16,m.a.awrap(a.login.login());case 16:if(!r){O.next=20;break}return O.next=19,m.a.awrap(k.a.verifyRemoteResource({url:i,token:t.oada.token}));case 19:t.app.verifyIntegrity=O.sent;case 20:if(!o){O.next=24;break}return O.next=23,m.a.awrap(k.a.verifyRemote({mask:c,token:t.oada.token}));case 23:t.app.verifyIntegrity=O.sent;case 24:if(u=t.app.verifyIntegrity,O.prev=25,p=null,!r){O.next=38;break}return t.app.original=h.a.clone(u.original),O.next=31,m.a.awrap(a.oada.get("".concat(u.original._meta._id,"/vdoc")));case 31:if(!(p=O.sent).error){O.next=34;break}throw p.error;case 34:b=p.data,t.app.originalVdoc=b,O.next=56;break;case 38:return f=d.match(/(\/resources\/[^\/]*)\/?(.*)/i),g=null,v=null,f&&(g=f[1],f[2].length>0&&(v=f[2])),t.app.resourcePath=v,O.next=45,m.a.awrap(a.oada.get("".concat(g)));case 45:if(!(p=O.sent).error){O.next=48;break}throw p.error;case 48:return t.app.original=p.data,O.next=51,m.a.awrap(a.oada.get("".concat(t.app.original._meta._id,"/vdoc")));case 51:if(!(p=O.sent).error){O.next=54;break}throw p.error;case 54:j=p.data,t.app.originalVdoc=j;case 56:t.app.resourcePath&&(t.view.Modals.VerifiedModal.open=!0),O.next=65;break;case 59:if(O.prev=59,O.t0=O.catch(25),O.t0.response){O.next=63;break}throw O.t0;case 63:403==h.a.get(O.t0,"response.status")?t.app.errorMessage="You do not have access to the original data.":404==h.a.get(O.t0,"response.status")?t.app.errorMessage="The original no longer exists at this location.":t.app.errorMessage="Opps! A unknown error occured.",t.app.error=!0;case 65:O.next=69;break;case 67:t.app.errorMessage="Oops! A valid link must be provided to application.",t.app.error=!0;case 69:t.app.finished=!0;case 70:case"end":return O.stop()}}),null,null,[[25,59]])}},I=a(203);var R=function(e){var t;return m.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.state,t=e.actions,e.effects,console.log("Started app"),I&&I.version&&(document.title=document.title+" - v"+I.version),a.next=5,m.a.awrap(t.app.processURL());case 5:case"end":return a.stop()}}))},V={showData:!1,finished:!1,trellisMask:null,maskedResourceURL:null,verifyIntegrity:{},original:null,originalVdoc:null,valid:function(e,t){var a=e.maskedResourceURL,n=(e.trellisMask,e.verifyIntegrity);if(a){if(n.match&&n.unchanged)return!0}else if(1==n.match)return!0;return!1}},M=x,W={oada:{url:"https://stage.smithfield.trellis.one",devcert:a(734),redirect:a(735).redirect_uris[1]}},_=h.a.merge({},W,null),C={url:_.oada.url,token:"",data:{documents:{}}},F=a(197),S=a.n(F),T=a(468),z=j.a.promisify(T.browser.getAccessToken),U=function(e){return"oada:"+e+":token"},Y={logout:function(e){var t,a;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,a=e.effects,n.next=3,m.a.awrap(a.oada.websocket.close());case 3:t.oada.data.documents={},delete window.localStorage[U(t.oada.url)];case 5:case"end":return n.stop()}}))},login:function(e){var t=e.state,a=e.actions;return j.a.try((function(){return window.localStorage[U(t.oada.url)]?(console.log("Already have a token for URL "+t.oada.url+", logout to clear"),window.localStorage[U(t.oada.url)]):(console.log("Do not have an access token, redirecting..."),z(t.oada.url.replace(/^https?:\/\//,""),{metadata:_.oada.devcert,scope:"all:all",redirect:_.oada.redirect}).then((function(e){return e.access_token})).catch((function(e){return t.login.error="Failed to redirect to "+t.oada.url+" for connection",console.log("FAILED TO GET ACCESS TOKEN: err = ",e),!1})))})).then((function(e){return e&&(window.localStorage[U(t.oada.url)]=e),t.oada.token=e,console.log("Have token, connecting to oada..."),a.oada.connect()})).then((function(e){console.log("Websocket connected.")}))},uploadFile:function(e,t){var a=e.state,n=e.actions;return S.a.request({url:"/resources",method:"post",baseURL:a.oada.url,headers:{Authorization:"Bearer "+a.oada.token,"Content-Disposition":"inline","Content-Type":t.type},data:t}).then((function(e){var a=e.headers["content-location"].split("/");return a=a[a.length-1],n.oada.put({url:"/resources/".concat(a,"/_meta"),data:{filename:t.name},headers:{"Content-Type":"application/json"}}).then((function(){return n.oada.createAndPostResource({url:"/bookmarks/trellisfw/documents",data:{pdf:{_id:"resources/"+a,_rev:0}}})}))}))},onDocumentsChange:function(e,t){var a=e.state,n=e.actions;if(console.log("onDocumentsChange",t),"merge"==h.a.get(t,"change.type")){var o=h.a.filter(Object.keys(h.a.get(t,"change.body")),(function(e){return!1===h.a.startsWith(e,"_")}));return j.a.map(o,(function(e){return n.oada.loadDocument(e)}))}if("delete"==h.a.get(t,"change.type")){var r=h.a.filter(Object.keys(h.a.get(t,"change.body")),(function(e){return!1===h.a.startsWith(e,"_")}));h.a.forEach(r,(function(e){delete a.oada.data.documents[e]}))}},loadDocument:function(e,t){var a=e.state,n=e.actions;return n.oada.get("/bookmarks/trellisfw/documents/"+t).then((function(e){var o=a.oada.data.documents[t]||{};return a.oada.data.documents[t]=h.a.merge({},o,e.data),n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/_meta")).then((function(e){if(null==e)throw Error("No data");var n=a.oada.data.documents[t]._meta;a.oada.data.documents[t]._meta=h.a.merge({},n,h.a.pick(e.data,["stats","services"]))})).catch((function(e){console.log("Error. Failed to load document _meta",t)})).then((function(){if(null!=a.oada.data.documents[t].pdf)return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/pdf/_meta")).then((function(e){if(null==e)throw Error("No data");var n=a.oada.data.documents[t].pdf._meta||{};a.oada.data.documents[t].pdf._meta=h.a.merge({},n,h.a.pick(e.data,["filename"]))})).catch((function(e){console.log("Error. Failed to load pdf _meta",t)}))})).then((function(){if(null!=a.oada.data.documents[t].audits)return j.a.map(h.a.keys(a.oada.data.documents[t].audits),(function(e){return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/audits/").concat(e)).then((function(n){if(null==n)throw Error("No data");var o=a.oada.data.documents[t].audits[e]||{};a.oada.data.documents[t].audits[e]=h.a.merge({},o,n.data)})).catch((function(a){console.log("Error. Failed to load audit ",e,"from doc",t)}))}))})).then((function(){if(null!=a.oada.data.documents[t]["audits-masked"])return j.a.map(h.a.keys(a.oada.data.documents[t]["audits-masked"]),(function(e){return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/audits-masked/").concat(e)).then((function(n){if(null==n)throw Error("No data");var o=a.oada.data.documents[t]["audits-masked"][e]||{};a.oada.data.documents[t]["audits-masked"][e]=h.a.merge({},o,n.data)})).catch((function(a){console.log("Error. Failed to load audit ",e,"from doc",t)}))}))})).then((function(){if(null!=a.oada.data.documents[t].cois)return j.a.map(h.a.keys(a.oada.data.documents[t].cois),(function(e){return n.oada.get("/bookmarks/trellisfw/documents/".concat(t,"/cois/").concat(e)).then((function(n){if(null==n)throw Error("No data");var o=a.oada.data.documents[t].cois[e]||{};a.oada.data.documents[t].cois[e]=h.a.merge({},o,n.data)})).catch((function(a){console.log("Error. Failed to load coi ",e,"from doc",t)}))}))}))})).catch((function(e){console.log("Error. Failed to load document",t,e)}))},createAndPostResource:function(e,t){var a=e.actions,n=t.url,o=t.data,r=t.contentType;return a.oada.createResource({data:o,contentType:r}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1],a.oada.post({url:n,headers:{"Content-Type":r||"application/json"},data:{_id:"resources/"+t,_rev:0}}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1]}))}))},createAndPostResourceHTTP:function(e,t){var a=e.actions,n=t.url,o=t.data,r=t.contentType;return a.oada.createResourceHTTP({data:o,contentType:r}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1],a.oada.postHTTP({url:n,headers:{"Content-Type":r||"application/json"},data:{_id:"resources/"+t,_rev:0}}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1]}))}))},createAndPutResource:function(e,t){var a=e.actions,n=t.url,o=t.data,r=t.contentType;return a.oada.createResource({data:o,contentType:r}).then((function(e){var t=e.headers["content-location"].split("/");return t=t[t.length-1],a.oada.put({url:n,headers:{"Content-Type":r||"application/json"},data:{_id:"resources/"+t,_rev:0}})}))},createResource:function(e,t){var a=e.actions,n=t.data,o=t.contentType,r={};return r["content-type"]=o||"application/json",a.oada.post({url:"/resources",data:n,headers:r})},createResourceHTTP:function(e,t){var a=e.actions,n=t.data,o=t.contentType,r={};return r["content-type"]=o||"application/json",a.oada.postHTTP({url:"/resources",data:n,headers:r})},doesResourceExist:function(e,t){return e.actions.oada.head(t).then((function(e){return null!=e})).catch((function(e){if(e.response&&404===e.response.status)return!1;throw e}))},connect:function(e){var t=e.state;return e.effects.oada.websocket.connect(t.oada.url)},get:function(e,t){var a=e.effects,n=e.state;return a.oada.websocket.http({method:"GET",url:t,headers:{Authorization:"Bearer "+n.oada.token}})},head:function(e,t){var a=e.effects,n=e.state;return a.oada.websocket.http({method:"HEAD",url:t,headers:{Authorization:"Bearer "+n.oada.token}})},post:function(e,t){var a=e.effects,n=e.state,o=t.url,r=t.headers,c=t.data;return console.log("Posting to url ",o),a.oada.websocket.http({method:"POST",url:o,headers:h.a.merge({Authorization:"Bearer "+n.oada.token},r),data:c})},postHTTP:function(e,t){e.effects;var a=e.state,n=t.url,o=t.headers,r=t.data;return S.a.request({url:n,method:"post",baseURL:a.oada.url,headers:h.a.merge({Authorization:"Bearer "+a.oada.token},o),data:r})},put:function(e,t){var a=e.effects,n=e.state,o=t.url,r=t.headers,c=t.data;return a.oada.websocket.http({method:"PUT",url:o,headers:h.a.merge({Authorization:"Bearer "+n.oada.token},r),data:c})},watch:function(e,t){var a=e.effects,n=e.actions,o=e.state,r=t.url,c=t.actionName;return a.oada.websocket.watch({url:r,headers:{Authorization:"Bearer "+o.oada.token}},(function(e){h.a.get(n,c)(e)}))}},E=a(204),N=a(15),D=a(121),J=a(29),L=a(54),Z=a(102);J.config({warnings:!1});var B=null,X=function(e,t){e.state,e.actions,e.effects},H=C,q=Y,G={websocket:{connect:function(e){return function(e){var t,a=[];e=e.replace("https://","wss://").replace("http://","ws://"),console.log("Creating WebSocket for",e);var n=!1,o={},r={};function c(){n&&(a.forEach((function(e){t.send(JSON.stringify(e))})),a=[])}return new J((function(a,i){console.log("Calling WebSocket(url)"),(t=new WebSocket(e)).onopen=function(e){console.log("We are connected via websocket"),n=!0,c(),a(t)},t.onclose=function(e){console.log("Websocket closed.")},t.onmessage=function(e){var t=JSON.parse(e.data);if(t.requestId)if(o[t.requestId]){if(t.status>=200&&t.status<300)o[t.requestId].resolve(t);else{var a=new Error("Request failed with status code "+t.status);a.request=o[t.requestId].request,a.response={status:t.status,statusText:t.statusText,headers:t.headers,data:t.data},a.originalStack=o[t.requestId].request.requestStack,o[t.requestId].reject(a)}delete o[t.requestId]}else if(r[t.requestId])if(r[t.requestId].resolve){if("success"===t.status)r[t.requestId].resolve(t);else{var n=new Error("Request failed with status code "+t.status);n.response=t,n.request=r[t.requestId].request,r[t.requestId].reject(n)}delete r[t.requestId].resolve,delete r[t.requestId].reject}else{if(null==r[t.requestId].callback)throw new Error("The given watch function has an undefined callback:",r[t.requestId]);r[t.requestId].callback(t)}}})).then((function(){return console.log("Returning websocket obj"),{url:e,http:function(e){return new J((function(t,n){var r=L.parse(e.url),i={requestId:Z(),method:e.method.toLowerCase(),path:r.path,data:e.data,headers:Object.entries(e.headers).map((function(e){var t=Object(D.a)(e,2),a=t[0],n=t[1];return Object(N.a)({},a.toLowerCase(),n)})).reduce((function(e,t){return Object(E.a)({},e,{},t)}))};a.push(i),o[i.requestId]={request:e,resolve:t,reject:n},c()}))},close:function(){a=[],o={},r={},t.close()},watch:function(e,t){var n=L.parse(e.url);return new J((function(o,i){var s={requestId:Z(),method:"watch",path:n.path,headers:Object.entries(e.headers).map((function(e){var t=Object(D.a)(e,2),a=t[0],n=t[1];return Object(N.a)({},a.toLowerCase(),n)})).reduce((function(e,t){return Object(E.a)({},e,{},t)}))};a.push(s),r[s.requestId]={request:e,resolve:o,reject:i,callback:t},c()}))},unwatch:function(e,t){var n=L.parse(e.url);return new J((function(o,i){var s={requestId:Z(),method:"unwatch",path:n.path,headers:Object.entries(e.headers).map((function(e){var t=Object(D.a)(e,2),a=t[0],n=t[1];return Object(N.a)({},a.toLowerCase(),n)})).reduce((function(e,t){return Object(E.a)({},e,{},t)}))};a.push(s),r[s.requestId]={request:e,resolve:o,reject:i,callback:t},c()}))}}}))}(e).then((function(e){B=e}))},watch:function(e,t){return B.watch(e,t)},http:function(e){return B.http(e).catch((function(e){return e.response&&e.response.status?404==e.response.status?(console.log("HTTP 404",h.a.get(e,"response.headers.content-location")),{error:e}):403==e.response.status?(console.log("HTTP 403",h.a.get(e,"response.headers.content-location")),{error:e}):(console.log("HTTP Error: ",e),{error:e}):(console.log("HTTP Error",e),{error:e})}))},close:function(){if(B)return console.log("Closing web socket..."),B.close();console.log("WARNING: tried to close a null websocket!")}}},P=a(205),A={Pages:{selectedPage:"Data",Data:{search:"",openFileBrowser:!1,uploading:{}}},Modals:{VerifiedModal:{open:!1,showData:!1,data:function(e,t){return Object(P.a)(e),t.app.verifyIntegrity.original},path:function(e,t){return Object(P.a)(e),t.app.resourcePath},type:function(e,t){Object(P.a)(e);var a=h.a.get(t,"app.original._type");return"application/vnd.trellisfw.audit.sqfi.1+json"==a?"audit":"application/vnd.trellisfw.coi.accord+json"==a?"coi":void 0}}}},Q=(a(102),A),K={TopBar:{logout:function(e){e.state;var t=e.actions;t.login.logout(),t.oada.logout()}},Modals:{VerifiedModal:{toggleShowData:function(e,t){var a=e.state;a.view.Modals.VerifiedModal.showData=!a.view.Modals.VerifiedModal.showData},close:function(e){var t=e.state;e.actions;t.view.Modals.VerifiedModal.open=!1}}}},$={domain:_.oada&&_.oada.url?_.oada.url:""},ee={login:function(e){var t,a,n;return m.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.state,a=e.actions,t.login.loading=!0,t.oada.url=t.login.domain.match(/^http/)?t.login.domain:"https://"+t.login.domain,o.next=5,m.a.awrap(a.oada.login());case 5:if(t.login.loading=!1,!t.oada.token){o.next=12;break}return t.login.loggedIn=!0,o.next=10,m.a.awrap(a.oada.get("/users/me"));case 10:n=o.sent,t.login.name=n&&n.data&&n.data.username;case 12:case"end":return o.stop()}}))},logout:function(e){var t,a;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,a=e.actions,n.next=3,m.a.awrap(a.oada.logout());case 3:return t.login.loggedIn=!1,t.app.finished=!1,n.next=7,m.a.awrap(a.app.processURL());case 7:case"end":return n.stop()}}))},domainChange:function(e,t){e.state.login.domain=t.value}},te=Object(b.a)({app:n,oada:o,view:r,login:c}),ae=Object(p.b)(),ne=(a(788),a(4)),oe=a(982);var re=function(){var e=ae(),t=e.actions,a=e.state;return a.app.skin,Object(ne.b)("div",{css:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#fff",minHeight:"85px",borderBottom:"1px solid #979797"}},Object(ne.b)("img",{css:{height:"70px",paddingLeft:"20px"},src:"logo.svg",alt:"logo"}),Object(ne.b)("div",{css:{marginRight:50}},Object(ne.b)(oe.a,{text:a.login.name},Object(ne.b)(oe.a.Menu,null,Object(ne.b)(oe.a.Item,{icon:"power",text:"Logout",value:"logout",onClick:t.view.TopBar.logout})))))},ce=a(983);var ie=function(e){var t=e.coi,a=t.producer&&t.producer.name?t.producer.name:"Unknown";return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Producer"),Object(ne.b)(ce.a.Cell,null,a))};var se=function(e){var t=e.coi,a=t.holder&&t.holder.name?t.holder.name:"Unknown";return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Holder"),Object(ne.b)(ce.a.Cell,null,a))},le=a(98),de=a(72),ue=a.n(de),pe=a(978),be=a(981);function fe(){var e=Object(le.a)(["\n          .MuiChip-root {\n            font-family: inherit;\n            font-size: 14px;\n            line-height: 16px;\n            margin-left: 3px;\n            margin-top: 3px;\n          }\n          .MuiChip-root:first-of-type {\n            margin-left: 0px;\n          }\n        "]);return fe=function(){return e},e}var he=function(e){var t=e.coi,a=h.a.cloneDeep(t.policies)||[];return a=h.a.filter(a,(function(e){if(e.start=ue()(e.effective_date),e.end=ue()(e.expire_date),!e.start.isValid())return!1;if(!e.end.isValid())return!1;var t=ue()();return e.expired=e.start.isAfter(t)||e.end.isBefore(t),!0})),Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Policies"),Object(ne.b)(ce.a.Cell,{css:Object(ne.a)(fe())},h.a.map(a,(function(e,t){return Object(ne.b)(be.a,{key:t,content:Object(ne.b)("div",null,Object(ne.b)("div",{css:{textAlign:"center"}},"Effective"),Object(ne.b)("div",null,"".concat(e.start.format("MMMM d, YYYY")," to ").concat(e.end.format("MMMM d, YYYY")))),trigger:Object(ne.b)(pe.a,{color:e.expired?"secondary":"default",label:"".concat(e.number).concat(e.expired?": EXPIRED":"")})})}))))};var ge=function(e){var t=e.coi;return e.document,Object(ne.b)(ce.a,{celled:!0,striped:!0,css:{maxWidth:800}},Object(ne.b)(ce.a.Body,{css:{fontSize:16}},Object(ne.b)(ie,{coi:t}),Object(ne.b)(se,{coi:t}),Object(ne.b)(he,{coi:t})))};var me=function(e){var t=e.audit,a=t.organization&&t.organization.name?t.organization.name:"Unknown";return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Organization"),Object(ne.b)(ce.a.Cell,null,a))};function ve(){var e=Object(le.a)(["\n          .MuiChip-root {\n            font-family: inherit;\n            font-size: 14px;\n            line-height: 16px;\n            margin-left: 3px;\n            margin-top: 3px;\n          }\n          .MuiChip-root:first-of-type {\n            margin-left: 0px;\n          }\n        "]);return ve=function(){return e},e}var je=function(e){var t=e.audit;return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Scope (Products)"),Object(ne.b)(ce.a.Cell,{css:Object(ne.a)(ve())},h.a.map(t.scope.products_observed,(function(e,t){return Object(ne.b)(pe.a,{key:t,label:e.name})}))))};var Oe=function(e){var t=e.audit;return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Score"),Object(ne.b)(ce.a.Cell,null,"".concat(t.score.final.value," "),t.score.rating?Object(ne.b)("span",{style:{color:t.score.rating.match(/(good|excellent)/i)?"green":"red"}},"(",t.score.rating.trim(),")"):""))};var we=function(e){var t=e.audit,a=null;if(t.certificate_validity_period&&t.certificate_validity_period.start&&t.certificate_validity_period.end){(a={start:ue()(t.certificate_validity_period.start,"M/D/YYYY"),end:ue()(t.certificate_validity_period.end,"M/D/YYYY")}).start&&a.start.isValid()||(a=null),a.end&&a.end.isValid()||(a=null);var n=ue()();a.expired=a.start.isAfter(n)||a.end.isBefore(n)}return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Validity"),Object(ne.b)(ce.a.Cell,null,a?a.expired?Object(ne.b)("span",{style:{color:"red"}},"EXPIRED!"):Object(ne.b)("span",{style:{color:"green"}},"VALID (from ".concat(a.start.format("MMM d, YYYY")," to ").concat(a.end.format("MMM d, YYYY"),")")):""))};var ye=function(e){var t=e.audit;return Object(ne.b)(ce.a,{celled:!0,striped:!0,css:{maxWidth:800}},Object(ne.b)(ce.a.Body,{css:{fontSize:16}},Object(ne.b)(me,{audit:t}),Object(ne.b)(Oe,{audit:t}),Object(ne.b)(je,{audit:t}),Object(ne.b)(we,{audit:t})))},ke=a(285);var xe=function(e){var t=e.oada,a=e.path,n={Authorization:"Bearer "+t.token},o="".concat(t.url,"/").concat(a);return Object(ne.b)("div",null,Object(ne.b)(ke.a,{file:{url:o,httpHeaders:n},onLoadSuccess:function(e){e.numPages}},Object(ne.b)(ke.b,{className:"pdfPage",pageNumber:1,width:900})))},Ie=a(200),Re=a.n(Ie),Ve=a(984);var Me=function(){var e=ae(),t=e.actions,a=e.state,n=a.app.original||{},o=a.app.originalVdoc||{},r=null;return n&&((r=h.a.cloneDeep(n))._id&&delete r._id,r._rev&&delete r._rev,r._type&&delete r._type,r._meta&&delete r._meta),Object(ne.b)("div",{css:{display:"flex",flexDirection:"column",flex:"1",boxShadow:"inset 5px 5px 5px #dddddd",padding:10,alignItems:"center"}},Object(ne.b)("div",{css:{height:20}}),a.app.maskedResourceURL?a.app.valid?Object(ne.b)("div",{css:{fontSize:25,color:"green"}},"Integrity of document verified."):Object(ne.b)("div",{css:{fontSize:25,color:"red"}},"Could not verify document integrity."):null,Object(ne.b)("div",{css:{height:10}}),"application/vnd.trellisfw.audit.sqfi.1+json"==n._type?Object(ne.b)(ye,{audit:n}):null,"application/vnd.trellisfw.coi.accord+json"==n._type?Object(ne.b)(ge,{coi:n}):null,o.pdf?Object(ne.b)(xe,{oada:a.oada,path:"".concat(o.pdf._id)}):null,a.app.showData?Object(ne.b)(Re.a,{src:r,name:"data",collapsed:1,collapseStringsAfterLength:50,displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1}):null,Object(ne.b)(Ve.a,{onClick:function(){t.app.toggleShowData()}},a.app.showData?"Hide Data":"View Data"))},We=a(979),_e=a(985),Ce=a(122);var Fe=function(e){var t=ae(),a=t.state,n=t.actions,o=(a.view.Modals.VerifiedModal,n.view.Modals.VerifiedModal);return Object(ne.b)(_e.a,null,Object(ne.b)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"center"}},a.app.valid?Object(ne.b)("div",{css:{fontSize:25,color:"green"}},"Data Integrity Verified"):Object(ne.b)("div",{css:{fontSize:25,color:"red"}},"WARNING: Could not verify data integrity!"),Object(ne.b)(Ve.a,{icon:!0,onClick:function(){return o.close()}},Object(ne.b)(Ce.a,{name:"x"}))))};var Se=function(e){var t=e.data;return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Organization Location"),Object(ne.b)(ce.a.Cell,null,Object(ne.b)("div",null,t.street_address),Object(ne.b)("div",null,"".concat(t.city,", ").concat(t.state," ").concat(t.postal_code)),Object(ne.b)("div",null,t.country)))};var Te=function(e){var t=e.data;return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},"Scope Operation Location"),Object(ne.b)(ce.a.Cell,null,Object(ne.b)("div",null,t.address),Object(ne.b)("div",null,"".concat(t.city,", ").concat(t.state," ").concat(t.postal_code)),Object(ne.b)("div",null,t.country)))};var ze=function(e){var t=e.data,a=e.path;return Object(ne.b)(ce.a,{definition:!0},Object(ne.b)(ce.a.Body,{css:{fontSize:16}},"organization/location"==a?Object(ne.b)(Se,{data:t}):null,"scope/operation/location"==a?Object(ne.b)(Te,{data:t}):null))};var Ue=function(e){var t=e.data,a=e.title;return Object(ne.b)(ce.a.Row,null,Object(ne.b)(ce.a.Cell,{collapsing:!0,css:{fontWeight:"bold"}},a),Object(ne.b)(ce.a.Cell,null,Object(ne.b)("div",null,t.street_address),Object(ne.b)("div",null,"".concat(t.city,", ").concat(t.state," ").concat(t.postal_code)),Object(ne.b)("div",null,t.country)))};var Ye=function(e){var t=e.data,a=e.path;return Object(ne.b)(ce.a,{definition:!0},Object(ne.b)(ce.a.Body,{css:{fontSize:16}},"producer/location"==a?Object(ne.b)(Ue,{title:"Producer Location",data:t}):null,"holder/location"==a?Object(ne.b)(Ue,{title:"Holder Location",data:t}):null,"insured/location"==a?Object(ne.b)(Ue,{title:"Insured Location",data:t}):null))};var Ee=function(e){var t=ae(),a=t.actions,n=t.state,o=a.view.Modals.VerifiedModal,r=n.view.Modals.VerifiedModal,c=null,i=r.path;return r.data&&((c=h.a.cloneDeep(r.data))._id&&delete c._id,c._rev&&delete c._rev,c._type&&delete c._type,c._meta&&delete c._meta),Object(ne.b)("div",null,Object(ne.b)("div",{css:{color:"#2439FF",fontSize:16,marginBottom:7,display:"flex",flexDirection:"column",alignItems:"center"}},"audit"==r.type?Object(ne.b)(ze,{data:r.data,path:r.path}):null,"coi"==r.type?Object(ne.b)(Ye,{data:r.data,path:r.path}):null,r.showData?null==c?Object(ne.b)("span",null,"< No Data >"):Object(ne.b)(Re.a,{src:c,name:i,collapsed:1,collapseStringsAfterLength:50,displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1}):"",Object(ne.b)("div",{css:{display:"flex"}},Object(ne.b)(Ve.a,{onClick:function(){o.toggleShowData(h.a.get(r,"documentKey"))}},r.showData?"Hide Data":"View Data"),Object(ne.b)("div",{css:{width:40}}),Object(ne.b)(Ve.a,{onClick:function(){o.close()}},"Close"))))};var Ne=function(e){var t=ae(),a=t.actions,n=t.state,o=a.view.Modals.VerifiedModal,r=n.view.Modals.VerifiedModal;return Object(ne.b)(We.a,{open:r.open,onClose:o.close},Object(ne.b)(Fe,null),Object(ne.b)(We.a.Content,null,Object(ne.b)("div",{css:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},Object(ne.b)(Ee,null))))};a(953);function De(){var e=Object(le.a)(["\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        font-size: 1.2em;\n        color: #FFFFFF;\n        cursor: pointer;\n      "]);return De=function(){return e},e}function Je(){var e=Object(le.a)(["\n      height: 100vh;\n      width: 100vw;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n    "]);return Je=function(){return e},e}var Le=function(){var e=ae(),t=e.state,a=e.actions,n=(t.app,t.login,a.login);return Object(ne.b)("div",{css:Object(ne.a)(Je())},Object(ne.b)("img",{css:{height:100,marginBottom:25},src:"logo.svg",alt:"logo"}),Object(ne.b)("img",{css:{height:100,marginBottom:25},src:"magnify.svg",alt:"logo"}),Object(ne.b)("div",{css:{fontSize:20,paddingBottom:100}},"Verifying your data..."),Object(ne.b)("a",{css:Object(ne.a)(De()),onClick:n.logout},"Logout"))};var Ze=function(){var e=ae(),t=e.state;return e.actions,t.app.finished?Object(ne.b)("div",{css:{height:"100vh",width:"100vw",display:"flex",flexDirection:"column",justifyContent:"stretch"}},Object(ne.b)(re,null),Object(ne.b)("div",{css:{flex:1,display:"flex",flexDirection:"row",alignItems:"stretch"}},Object(ne.b)(Me,null),Object(ne.b)(Ne,null))):Object(ne.b)(Le,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Be=Object(u.c)(te,{devtools:!0});d.a.render(s.a.createElement(p.a,{value:Be},s.a.createElement(Ze,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[506,1,2]]]);
//# sourceMappingURL=main.90d0b288.chunk.js.map